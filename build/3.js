webpackJsonp([3],{1748:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"AddonModAssignSubmissionReviewPageModule",function(){return u});var i=n(0),o=n(3),s=n(2),a=n(16),r=n(15),d=n(1839),c=n(1864),l=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(){function e(){}return e=l([Object(i.I)({declarations:[c.a],imports:[a.a,r.a,d.a,o.l.forChild(c.a),s.b.forChild()]})],e)}()},1839:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n(0),o=n(17),s=n(3),a=n(2),r=n(16),d=n(15),c=n(75),l=n(43),u=n(877),p=n(878),f=n(881),g=n(1840),h=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(){function e(){}return e=h([Object(i.I)({declarations:[u.a,p.a,f.a,g.a],imports:[o.b,s.k,a.b.forChild(),r.a,d.a,c.a,l.a],providers:[],exports:[u.a,p.a,f.a,g.a],entryComponents:[u.a]})],e)}()},1840:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n(0),o=n(51),s=n(110),a=n(111),r=n(154),d=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(){function e(e,t,n,i){this.injector=e,this.feedbackDelegate=t,this.assignProvider=n,this.assignHelper=i,this.component=o.a.COMPONENT,this.text="",this.files=[]}return e.prototype.ngOnInit=function(){var e=this;this.plugin?(this.plugin.name=this.feedbackDelegate.getPluginName(this.plugin),this.plugin.name?(this.edit=this.edit&&"false"!==this.edit,this.canEdit=this.canEdit&&"false"!==this.canEdit,this.feedbackDelegate.getComponentForPlugin(this.injector,this.plugin).then(function(t){e.pluginComponent=t,t?e.data={assign:e.assign,submission:e.submission,plugin:e.plugin,userId:e.userId,configs:e.assignHelper.getPluginConfig(e.assign,"assignfeedback",e.plugin.type),edit:e.edit,canEdit:e.canEdit}:(e.text=e.assignProvider.getSubmissionPluginText(e.plugin),e.files=e.assignProvider.getSubmissionPluginAttachments(e.plugin),e.notSupported=e.feedbackDelegate.isPluginSupported(e.plugin.type),e.pluginLoaded=!0)})):this.pluginLoaded=!0):this.pluginLoaded=!0},e.prototype.invalidate=function(){return Promise.resolve(this.dynamicComponent&&this.dynamicComponent.callComponentFunction("invalidate",[]))},d([Object(i._9)(r.a),c("design:type",r.a)],e.prototype,"dynamicComponent",void 0),d([Object(i.D)(),c("design:type",Object)],e.prototype,"assign",void 0),d([Object(i.D)(),c("design:type",Object)],e.prototype,"submission",void 0),d([Object(i.D)(),c("design:type",Object)],e.prototype,"plugin",void 0),d([Object(i.D)(),c("design:type",Number)],e.prototype,"userId",void 0),d([Object(i.D)(),c("design:type",Object)],e.prototype,"canEdit",void 0),d([Object(i.D)(),c("design:type",Object)],e.prototype,"edit",void 0),e=d([Object(i.m)({selector:"addon-mod-assign-feedback-plugin",template:'\n<core-dynamic-component [component]="pluginComponent" [data]="data">\n    \x3c!-- This content will be replaced by the component if found. --\x3e\n    <core-loading [hideUntil]="pluginLoaded">\n        <ion-item text-wrap *ngIf="text.length > 0 || files.length > 0">\n            <h2>{{ plugin.name }}</h2>\n            <ion-badge *ngIf="notSupported" color="primary">\n                {{ \'addon.mod_assign.feedbacknotsupported\' | translate }}\n            </ion-badge>\n            <p *ngIf="text">\n                <core-format-text [component]="component" [componentId]="assign.cmid" [maxHeight]="80" [fullOnClick]="true" [fullTitle]="plugin.name" [text]="text"></core-format-text>\n            </p>\n            <core-file *ngFor="let file of files" [file]="file" [component]="component" [componentId]="assign.cmid" [alwaysDownload]="true"></core-file>\n        </ion-item>\n    </core-loading>\n</core-dynamic-component>\n'}),c("design:paramtypes",[i.C,a.a,o.a,s.a])],e)}()},1864:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n(0),o=n(3),s=n(11),a=n(10),r=n(51),d=n(878),c=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(o=e[r])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e,t,n,i,o){this.navCtrl=t,this.courseProvider=n,this.appProvider=i,this.assignProvider=o,this.forceLeave=!1,this.moduleId=e.get("moduleId"),this.courseId=e.get("courseId"),this.submitId=e.get("submitId"),this.blindId=e.get("blindId"),this.showGrade=!!e.get("showGrade")}return e.prototype.ngOnInit=function(){var e=this;this.fetchSubmission().finally(function(){e.loaded=!0})},e.prototype.ionViewCanLeave=function(){return!(this.submissionComponent&&!this.forceLeave)||this.submissionComponent.canLeave()},e.prototype.fetchSubmission=function(){var e=this;return this.assignProvider.getAssignment(this.courseId,this.moduleId).then(function(t){return e.assign=t,e.title=e.assign.name,e.blindMarking=e.assign.blindmarking&&!e.assign.revealidentities,e.courseProvider.getModuleBasicGradeInfo(e.moduleId).then(function(t){if(t)if(t.advancedgrading&&t.advancedgrading[0]&&void 0!==t.advancedgrading[0].method){e.canSaveGrades="simple"==(t.advancedgrading[0].method||"simple")}else e.canSaveGrades=!0})})},e.prototype.refreshAllData=function(){var e=this,t=[];return t.push(this.assignProvider.invalidateAssignmentData(this.courseId)),this.assign&&(t.push(this.assignProvider.invalidateSubmissionData(this.assign.id)),t.push(this.assignProvider.invalidateAssignmentUserMappingsData(this.assign.id)),t.push(this.assignProvider.invalidateSubmissionStatusData(this.assign.id,this.submitId,this.blindMarking))),Promise.all(t).finally(function(){return e.submissionComponent&&e.submissionComponent.invalidateAndRefresh(),e.fetchSubmission()})},e.prototype.refreshSubmission=function(e){this.refreshAllData().finally(function(){e.complete()})},e.prototype.submitGrade=function(){var e=this;this.submissionComponent&&this.submissionComponent.submitGrade().then(function(){e.appProvider.isWide()||(e.forceLeave=!0,e.navCtrl.pop())})},c([Object(i._9)(d.a),l("design:type",d.a)],e.prototype,"submissionComponent",void 0),e=c([Object(i.m)({selector:"page-addon-mod-assign-submission-review",template:'<ion-header>\n    <ion-navbar>\n        <ion-title><core-format-text [text]="title"></core-format-text></ion-title>\n\n        <ion-buttons end></ion-buttons>\n    </ion-navbar>\n\n    <core-navbar-buttons end>\n        <button [hidden]="!canSaveGrades" ion-button button-clear (click)="submitGrade()" [attr.aria-label]="\'core.done\' | translate">\n            {{ \'core.done\' | translate }}\n        </button>\n    </core-navbar-buttons>\n</ion-header>\n<ion-content>\n\n    <ion-refresher [enabled]="loaded" (ionRefresh)="refreshSubmission($event)">\n        <ion-refresher-content pullingText="{{ \'core.pulltorefresh\' | translate }}"></ion-refresher-content>\n    </ion-refresher>\n    <core-loading [hideUntil]="loaded">\n        <addon-mod-assign-submission [courseId]="courseId" [moduleId]="moduleId" [submitId]="submitId" [blindId]="blindId" [showGrade]="showGrade"></addon-mod-assign-submission>\n    </core-loading>\n</ion-content>\n'}),l("design:paramtypes",[o.r,o.q,a.a,s.a,r.a])],e)}()}});